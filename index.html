<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, maximum-scale=1.0, user-scalable=no" />
  <title>Jalalabad Mosque</title>

  <!-- Google Font: Inter (for a sleeker look) -->
  <link
    rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap"
  />

  <!-- Favicon (using your GitHub raw PNG) -->
  <link
    rel="icon"
    type="image/png"
    href="https://raw.githubusercontent.com/JalalabadMasjid/jalalabadmasjid/refs/heads/main/images/jalalabad_masjid_web_app_logo.png"
  />

  <!-- Open Graph Meta Tags (for WhatsApp, etc.) -->
  <meta property="og:title" content="Jalalabad Mosque" />
  <meta property="og:description" content="Prayer Timetable & Community Updates" />
  <meta property="og:url" content="https://jalalabadmasjid.github.io/jalalabadmasjid/" />
  <meta property="og:type" content="website" />
  <meta
    property="og:image"
    content="https://raw.githubusercontent.com/JalalabadMasjid/jalalabadmasjid/refs/heads/main/images/jalalabad_masjid_web_app_logo.png"
  />

  <!-- Weather Icons by Erik Flowers (v2.0.9) -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/weather-icons/2.0.9/css/weather-icons.min.css"
    integrity="sha512-9N7p+IGexZTxGPa0BJqOAzsNNoOkTLO4qlZbdNKk5LbeCEu5ZIO8iYJ2IfS7yynMfubF9CV+0mZClBOf9W5yxg=="
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  />
  <!-- Font Awesome for icons -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"
    crossorigin="anonymous"
    referrerpolicy="no-referrer"
  />
  
  <style>
    :root {
      /* Core Colors */
      --primary-color: #007AFF;
      --accent-color: #5E5CE6;   
      --bg-color: #F5F5F7;
      --card-bg: #FFFFFF;
      --text-color: #1C1C1E;
      --secondary-text: #6E6E73;
      --border-color: rgba(0, 0, 0, 0.06);

      /* Layout & Effects */
      --border-radius: 16px;
      --shadow: 0 4px 16px rgba(0, 0, 0, 0.08);

      /* Typography */
      --title-font-size: 34px;
      --title-weight: 700;
      --time-font-size: 26px;
      --label-font-size: 14px;
      --nav-font-size: 13px;
    }

    @media (prefers-color-scheme: dark) {
      :root {
        --primary-color: #0A84FF;
        --accent-color: #5E5CE6;
        --bg-color: #000000; 
        --card-bg: #1C1C1E;
        --text-color: #FFFFFF;
        --secondary-text: #98989D;
        --border-color: rgba(255, 255, 255, 0.15);
        --shadow: 0 4px 16px rgba(255, 255, 255, 0.08);
      }
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    html, body {
      height: 100%;
      margin: 0;
    }

    body {
      /* Use Inter if available, otherwise system fonts */
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      -webkit-text-size-adjust: 100%;
    }

    .container {
      max-width: 800px;
      width: 100%;
      margin: 0 auto;
      padding: 12px 20px;
      padding-bottom: 70px; /* Enough bottom padding so content isn't hidden behind nav pills */
      flex: 1;
    }

    /* Header */
    header {
      text-align: center;
      margin-bottom: 8px;
      padding: 0;
      position: relative;
    }
    header h1 {
      font-size: var(--title-font-size);
      font-weight: var(--title-weight);
      letter-spacing: -0.5px;
      margin: 0;
      background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    /* Date & Ramadan Info */
    .date-section {
      text-align: center;
      margin: 8px 0 14px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .date-display {
      font-weight: 500;
      font-size: 16px;
      margin-bottom: 5px;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .date-nav-btn {
      background-color: var(--primary-color);
      border: none;
      color: #fff;
      border-radius: 50%;
      width: 36px;
      height: 36px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 16px;
      transition: background-color 0.3s ease;
    }
    .date-nav-btn:hover {
      background-color: var(--accent-color);
    }
    .ramadan-counter {
      background-color: var(--accent-color);
      color: white;
      padding: 6px 16px;
      border-radius: 15px;
      font-size: 14px;
      font-weight: 600;
      margin-top: 8px;
      display: inline-flex;
      align-items: center;
    }
    .ramadan-counter svg {
      margin-right: 6px;
      width: 16px;
      height: 16px;
    }

    /* Sections (Timetable / Community / About) */
    #timetable-section,
    #community-section,
    #about-section {
      display: none; /* toggled via JS */
    }

    /* Prayer Cards Grid */
    .prayer-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 16px;
      margin-bottom: 15px;
    }

    /* Prayer Card */
    .prayer-card {
      background-color: var(--card-bg);
      border-radius: var(--border-radius);
      padding: 20px;
      box-shadow: var(--shadow);
      border: 1px solid var(--border-color);
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      cursor: default;
      opacity: 0;
      transform: translateY(10px);
    }
    .prayer-card.fade-in {
      animation: fadeInUp 0.8s forwards ease;
    }
    @keyframes fadeInUp {
      0% {
        opacity: 0;
        transform: translateY(10px);
      }
      100% {
        opacity: 1;
        transform: translateY(0);
      }
    }
    .prayer-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
    }

    /* Prayer Icon */
    .prayer-icon {
      font-size: 42px;
      margin-bottom: 12px;
      color: var(--primary-color);
      flex-shrink: 0;
    }

    /* Prayer Details */
    .prayer-name {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 6px;
      text-align: center;
    }
    .prayer-label {
      font-size: var(--label-font-size);
      color: var(--secondary-text);
      margin-bottom: 6px;
      text-align: center;
      background-color: rgba(0, 122, 255, 0.1);
      border-radius: 12px;
      padding: 3px 10px;
      display: inline-block;
    }
    .prayer-time {
      font-size: var(--time-font-size);
      font-weight: 700;
      margin-bottom: 4px;
      color: var(--primary-color);
      text-align: center;
    }
    .jamat-label {
      font-size: 13px;
      color: var(--secondary-text);
      margin-top: -2px;
      margin-bottom: 2px;
      text-align: center;
      font-weight: 500;
    }
    .prayer-time-secondary {
      font-size: 15px;
      color: var(--primary-color);
      margin-top: 2px;
      text-align: center;
      font-weight: 600;
    }

    /* Community & About Section fade classes */
    .community-fade {
      opacity: 0;
      transform: translateY(10px);
    }
    .community-fade.fade-in {
      animation: fadeInUp 0.4s forwards ease;
    }
    .community-card {
      background-color: var(--card-bg);
      border-radius: var(--border-radius);
      padding: 16px;
      box-shadow: var(--shadow);
      border: 1px solid var(--border-color);
      margin-bottom: 16px;
      position: relative;
    }
    .announcement-badge {
      position: absolute;
      top: -10px;
      left: -10px;
      background-color: var(--accent-color);
      color: #fff;
      font-size: 12px;
      font-weight: 600;
      padding: 6px 10px;
      border-radius: 15px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }
    .announcement-date {
      font-size: 13px;
      color: var(--secondary-text);
      margin-bottom: 6px;
    }
    .announcement-text {
      font-size: 15px;
      line-height: 1.4;
    }

    /* "Now" & "Next" Badges */
    .current-prayer::after,
    .next-prayer::after {
      position: absolute;
      top: -10px;
      right: -10px;
      color: white;
      font-size: 12px;
      font-weight: 600;
      padding: 4px 10px;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
      content: attr(data-badge);
    }
    .current-prayer[data-badge="Now"]::after {
      background-color: #30D158;
      
    }
    .next-prayer[data-badge="Next"]::after {
      background-color: #FF2D55;
    }

    /* Hadith Footer (only on Timetable Section) */
    .hadith-footer {
      text-align: center;
      margin: 15px 0;
      padding: 8px;
      background-color: var(--accent-color);
      color: #fff;
      border-radius: var(--border-radius);
      font-size: 14px;
      line-height: 1.3;
    }

    /* Bottom Nav (Pill-based, invisible background) */
    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background-color: transparent;
      box-shadow: none;
      /* iOS safe-area inset to avoid home indicator overlap */
      padding-bottom: calc(env(safe-area-inset-bottom) + 10px);
      display: flex;
      justify-content: center;
      align-items: center;
      padding-top: 14px;
      z-index: 999;
    }
    .nav-pill {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      margin: 0 12px;
      padding: 10px 14px;
      border-radius: 30px;
      font-size: var(--nav-font-size);
      font-weight: 600;
      color: var(--text-color);
      background-color: transparent;
      border: 1px solid var(--border-color);
      cursor: pointer;
      transition: background-color 0.3s ease, color 0.3s ease;
    }
    .nav-pill i {
      font-size: 20px;
      margin-bottom: 4px;
    }
    .nav-pill span {
      display: block;
      line-height: 1.2;
    }
    .nav-pill.active {
      background-color: var(--primary-color);
      color: #fff;
      border-color: var(--primary-color);
    }
    .nav-pill:hover:not(.active) {
      background-color: rgba(0, 0, 0, 0.05);
    }

    /* Responsive Adjustments */
    @media (max-width: 600px) {
      .prayer-cards {
        grid-template-columns: 1fr 1fr;
      }
      .prayer-card {
        padding: 16px;
      }
      .prayer-name {
        font-size: 16px;
      }
      .prayer-time {
        font-size: 22px;
      }
    }
    @media (max-width: 400px) {
      .prayer-cards {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <header>
      <h1>Jalalabad Mosque</h1>
    </header>
    
    <!-- Timetable Section -->
    <section id="timetable-section">
      <!-- Date & Ramadan Info only for Timetable -->
      <div class="date-section">
        <div class="date-display">
          <button id="prev-date" class="date-nav-btn" aria-label="Previous Date">
            <i class="fas fa-chevron-left"></i>
          </button>
          <span id="current-date">Saturday, March 1, 2025</span>
          <button id="next-date" class="date-nav-btn" aria-label="Next Date">
            <i class="fas fa-chevron-right"></i>
          </button>
        </div>
        <div class="ramadan-counter" id="ramadan-counter">
          <svg viewBox="0 0 24 24" fill="white" aria-hidden="true">
            <path d="M12 2.25A9.75 9.75 0 1021.75 12 A9.76 9.76 0 0012 2.25zm0 17.25A7.5 7.5 0 1119.5 12 A7.5 7.5 0 0112 19.5z" fill-opacity="0.3"/>
            <path d="M12 22.5A10.5 10.5 0 0112 1.5a10.49 10.49 0 018 3.73 9.75 9.75 0 00-8 15.52A10.37 10.37 0 0112 22.5z"/>
          </svg>
          Ramadan: Day 1
        </div>
      </div>

      <!-- Prayer Cards -->
      <div class="prayer-cards" id="prayer-cards"></div>
      
      <!-- Hadith Footer visible only in Timetable Section -->
      <div class="hadith-footer">
        The best charity is that given in Ramadan.<br>
        Sunan Tirmidhi, Hadith: 663
      </div>
    </section>

    <!-- Community Section -->
    <section id="community-section">
      <!-- A simpler date display: no toggles, no Ramadan counter -->
      <div class="date-section">
        <div class="date-display">
          <span id="community-date">Saturday, March 1, 2025</span>
        </div>
      </div>

      <div class="community-fade">
        <div class="community-card">
          <div class="announcement-badge">Masjid Announcement</div>
          <div class="announcement-date">Feb 28, 2025</div>
          <div class="announcement-text">
            Ramadan Mubarak!<br>
            The moon has been sighted, and Taraweeh prayers will begin tonight at 8 PM. As usual, the men's prayer area will be in the main building, while the women's prayer area will be in the rear building. Ladies' WC facilities are accessible via the side entrance of the main building. <br><br> 
            A friendly reminder: No food is allowed during Taraweeh prayers. To be respectful of our neighbours, please avoid loitering outside the masjid when leaving.
          </div>
        </div>
      </div>
      <div class="community-fade" style="text-align: center; margin-bottom: 20px;">
        <a
          href="mailto:jalalabaddeveloper@gmail.com?subject=Community%20Message"
          style="display: inline-flex; align-items: center; justify-content: center; background-color: var(--primary-color); color: #fff; padding: 10px 16px; border-radius: 20px; text-decoration: none; font-weight: 600; box-shadow: var(--shadow);"
        >
          <span style="font-size: 20px; font-weight: bold; margin-right: 6px;">+</span>
          Submit a message
        </a>
      </div>
    </section>

    <!-- About Section -->
    <section id="about-section">
      <!-- New date display, just like Community -->
      <div class="date-section">
        <div class="date-display">
          <span id="about-date">Saturday, March 1, 2025</span>
        </div>
      </div>

      <div class="community-fade">
        <div class="community-card">
          <h2 style="margin-bottom: 8px;">About </h2>
          <p style="margin-top: 6px; line-height: 1.4;">
            This is a community project website built for personal use. It is not formally 
            affiliated with or approved by the masjid committee. <br><br>If you find it 
            useful, great! If you have any issues, please contact us via the community tab.
          </p>
        </div>
      </div>
    </section>
  </div>

  <!-- Bottom Nav (Invisible bar, visible pills) -->
  <div class="bottom-nav">
    <!-- Timetable Pill -->
    <button class="nav-pill" id="nav-timetable" aria-label="Timetable">
      <i class="wi wi-day-sunny" aria-hidden="true"></i>
      <span>Timetable</span>
    </button>
    <!-- Community Pill -->
    <button class="nav-pill" id="nav-community" aria-label="Community">
      <i class="wi wi-cloudy-gusts" aria-hidden="true"></i>
      <span>Community</span>
    </button>
    <!-- About Pill -->
    <button class="nav-pill" id="nav-about" aria-label="About">
      <i class="wi wi-stars" aria-hidden="true"></i>
      <span>About</span>
    </button>
  </div>
  
  <script>
    const dateOptions = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };

    // Prayer Data Array (dates in dd/mm/yy format)
    const prayerData = [
      {
        date: "01/03/25",
        fajr: "5:13 AM",
        fajrJamaat: "5:33 AM",
        sunrise: "6:53 AM",
        dhuhr: "12:24 PM",
        dhuhrJamaat: "1:15 PM",
        asr: "3:54 PM",
        asrJamaat: "4:30 PM",
        maghrib: "5:47 PM",
        maghribJamaat: "5:47 PM",
        isha: "7:16 PM",
        ishaJamaat: "8:00 PM"
      },
      {
        date: "02/03/25",
        fajr: "5:11 AM",
        fajrJamaat: "5:31 AM",
        sunrise: "6:51 AM",
        dhuhr: "12:24 PM",
        dhuhrJamaat: "1:15 PM",
        asr: "3:55 PM",
        asrJamaat: "4:30 PM",
        maghrib: "5:48 PM",
        maghribJamaat: "5:48 PM",
        isha: "7:17 PM",
        ishaJamaat: "8:00 PM"
      },
      {
        date: "03/03/25",
        fajr: "5:09 AM",
        fajrJamaat: "5:29 AM",
        sunrise: "6:49 AM",
        dhuhr: "12:24 PM",
        dhuhrJamaat: "1:15 PM",
        asr: "4:00 PM",
        asrJamaat: "4:30 PM",
        maghrib: "5:50 PM",
        maghribJamaat: "5:50 PM",
        isha: "7:18 PM",
        ishaJamaat: "8:00 PM"
      },
      {
        date: "04/03/25",
        fajr: "5:06 AM",
        fajrJamaat: "5:26 AM",
        sunrise: "6:46 AM",
        dhuhr: "12:24 PM",
        dhuhrJamaat: "1:15 PM",
        asr: "4:01 PM",
        asrJamaat: "4:30 PM",
        maghrib: "5:52 PM",
        maghribJamaat: "5:52 PM",
        isha: "7:20 PM",
        ishaJamaat: "8:00 PM"
      },
      {
        date: "05/03/25",
        fajr: "5:04 AM",
        fajrJamaat: "5:24 AM",
        sunrise: "6:44 AM",
        dhuhr: "12:23 PM",
        dhuhrJamaat: "1:15 PM",
        asr: "4:03 PM",
        asrJamaat: "4:30 PM",
        maghrib: "5:54 PM",
        maghribJamaat: "5:54 PM",
        isha: "7:21 PM",
        ishaJamaat: "8:00 PM"
      },
      {
        date: "06/03/25",
        fajr: "5:02 AM",
        fajrJamaat: "5:22 AM",
        sunrise: "6:42 AM",
        dhuhr: "12:23 PM",
        dhuhrJamaat: "1:15 PM",
        asr: "4:04 PM",
        asrJamaat: "4:30 PM",
        maghrib: "5:56 PM",
        maghribJamaat: "5:56 PM",
        isha: "7:23 PM",
        ishaJamaat: "8:00 PM"
      },
      {
        date: "07/03/25",
        fajr: "5:00 AM",
        fajrJamaat: "5:20 AM",
        sunrise: "6:40 AM",
        dhuhr: "12:23 PM",
        dhuhrJamaat: "1:15 PM",
        asr: "4:06 PM",
        asrJamaat: "4:30 PM",
        maghrib: "5:57 PM",
        maghribJamaat: "5:57 PM",
        isha: "7:23 PM",
        ishaJamaat: "8:00 PM"
      }
    ];

    // Helper to get today's date string in dd/mm/yy
    function getTodayString() {
      const d = new Date();
      const dd = String(d.getDate()).padStart(2, "0");
      const mm = String(d.getMonth() + 1).padStart(2, "0");
      const yy = String(d.getFullYear()).slice(-2);
      return `${dd}/${mm}/${yy}`;
    }

    // Convert "5:47 PM" -> total minutes from midnight
    function timeToMinutes(timeStr) {
      if (!timeStr || timeStr === "--") return null;
      const [time, meridian] = timeStr.split(" ");
      let [hh, mm] = time.split(":").map(Number);
      if (meridian === "PM" && hh < 12) hh += 12;
      if (meridian === "AM" && hh === 12) hh = 0;
      return hh * 60 + mm;
    }

    // Format "dd/mm/yy" to full date (e.g., "Saturday, March 1, 2025")
    function formatDisplayDate(dateStr) {
      const [dd, mm, yy] = dateStr.split("/");
      const fullYear = 2000 + parseInt(yy);
      const dateObj = new Date(fullYear, parseInt(mm) - 1, parseInt(dd));
      return dateObj.toLocaleDateString('en-US', dateOptions);
    }

    // Find today's date index if available
    let currentPrayerIndex = prayerData.findIndex(row => row.date === getTodayString());
    if (currentPrayerIndex === -1) currentPrayerIndex = 0;

    // Render prayer cards
    function renderPrayers(selectedRow) {
      const cardsContainer = document.getElementById("prayer-cards");
      cardsContainer.innerHTML = "";

      // We'll only show "Now"/"Next" if selected date = today
      const isToday = (selectedRow.date === getTodayString());

      let prayers = [];
      if (selectedRow) {
        prayers = [
          { name: "Fajr", startTime: selectedRow.fajr, jamatTime: selectedRow.fajrJamaat, iconClass: "wi-horizon" },
          { name: "Sunrise", startTime: selectedRow.sunrise, jamatTime: null, iconClass: "wi-sunrise" },
          { name: "Dhuhr", startTime: selectedRow.dhuhr, jamatTime: selectedRow.dhuhrJamaat, iconClass: "wi-day-sunny" },
          { name: "Asr", startTime: selectedRow.asr, jamatTime: selectedRow.asrJamaat, iconClass: "wi-day-sunny-overcast" },
          { name: "Maghrib", startTime: selectedRow.maghrib, jamatTime: selectedRow.maghribJamaat, iconClass: "wi-sunset" },
          { name: "Isha | Taraweeh", startTime: selectedRow.isha, jamatTime: selectedRow.ishaJamaat, iconClass: "wi-night-clear" }
        ];
      } else {
        // fallback if no row found
        prayers = [
          { name: "Fajr", startTime: "--", jamatTime: "--", iconClass: "wi-horizon" },
          { name: "Sunrise", startTime: "--", jamatTime: null, iconClass: "wi-sunrise" },
          { name: "Dhuhr", startTime: "--", jamatTime: "--", iconClass: "wi-day-sunny" },
          { name: "Asr", startTime: "--", jamatTime: "--", iconClass: "wi-day-sunny-overcast" },
          { name: "Maghrib", startTime: "--", jamatTime: "--", iconClass: "wi-sunset" },
          { name: "Isha | Taraweeh", startTime: "--", jamatTime: "--", iconClass: "wi-night-clear" }
        ];
      }

      // Determine current & next prayer based on current time (only if it's today)
      if (isToday) {
        const now = new Date();
        const nowMins = now.getHours() * 60 + now.getMinutes();
        const prayerMinutes = prayers.map(p => timeToMinutes(p.startTime));
        let currentIndex = -1;
        for (let i = 0; i < prayerMinutes.length; i++) {
          if (prayerMinutes[i] !== null && prayerMinutes[i] <= nowMins) {
            currentIndex = i;
          }
        }
        if (currentIndex >= 0) {
          prayers[currentIndex].isCurrent = true;
        }
        let nextIndex = currentIndex + 1;
        if (currentIndex === -1) {
          nextIndex = prayerMinutes.findIndex(m => m !== null);
        }
        if (nextIndex >= 0 && nextIndex < prayers.length) {
          prayers[nextIndex].isNext = true;
        }
      }

      // Render each prayer card
      prayers.forEach((p, idx) => {
        const card = document.createElement("div");
        card.className = "prayer-card";
        if (p.isCurrent) {
          card.classList.add("current-prayer");
          card.setAttribute("data-badge", "Now");
        } else if (p.isNext) {
          card.classList.add("next-prayer");
          card.setAttribute("data-badge", "Next");
        }
        card.innerHTML = `
          <i class="prayer-icon ${p.iconClass}" aria-hidden="true"></i>
          <div class="prayer-name">${p.name}</div>
          ${
            p.label
              ? `<div class="prayer-label">${p.label}</div>`
              : ""
          }
          <div class="prayer-time">${p.startTime || ""}</div>
          ${
            p.jamatTime
              ? `
                <div class="jamat-label">Jamaat</div>
                <div class="prayer-time-secondary">${p.jamatTime}</div>
              `
              : ""
          }
        `;
        cardsContainer.appendChild(card);

        // Staggered fade-in
        setTimeout(() => {
          card.classList.add("fade-in");
        }, idx * 100);
      });
    }

    // Ramadan Day logic
    function updateRamadanCounter(selectedRow) {
      const ramadanCounter = document.getElementById('ramadan-counter');
      if (!selectedRow) {
        ramadanCounter.textContent = 'Ramadan has ended';
        return;
      }

      // Ramadan starts March 1, 2025
      const ramadanStart = new Date(2025, 2, 1);

      // Convert "dd/mm/yy" to Date
      const [dd, mm, yy] = selectedRow.date.split("/");
      const fullYear = 2000 + parseInt(yy);
      const month = parseInt(mm) - 1; // zero-based
      const day = parseInt(dd);
      const selectedDateObj = new Date(fullYear, month, day);

      // Difference in days from Ramadan start
      const diffTime = selectedDateObj - ramadanStart; // ms
      const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
      const ramadanDay = diffDays + 1; // e.g. March 1 => 0+1 => Day 1

      if (ramadanDay < 1) {
        ramadanCounter.textContent = 'Ramadan has not started yet';
      } else if (ramadanDay > 30) {
        ramadanCounter.textContent = 'Ramadan has ended';
      } else {
        ramadanCounter.textContent = `Ramadan: Day ${ramadanDay}`;
      }
    }

    function updateDisplay(index) {
      const selectedRow = prayerData[index];
      // Update the timetable date
      document.getElementById('current-date').textContent = formatDisplayDate(selectedRow.date);
      // Update the community date
      document.getElementById('community-date').textContent = formatDisplayDate(selectedRow.date);
      // NEW: Also update the About date
      document.getElementById('about-date').textContent = formatDisplayDate(selectedRow.date);

      renderPrayers(selectedRow);
      updateRamadanCounter(selectedRow);
    }

    // Initialize
    updateDisplay(currentPrayerIndex);

    // Date nav
    document.getElementById('prev-date').addEventListener('click', () => {
      if (currentPrayerIndex > 0) {
        currentPrayerIndex--;
        updateDisplay(currentPrayerIndex);
      }
    });
    document.getElementById('next-date').addEventListener('click', () => {
      if (currentPrayerIndex < prayerData.length - 1) {
        currentPrayerIndex++;
        updateDisplay(currentPrayerIndex);
      }
    });

    // Bottom nav tab handling
    const timetableSection = document.getElementById("timetable-section");
    const communitySection = document.getElementById("community-section");
    const aboutSection = document.getElementById("about-section");

    const navTimetable = document.getElementById("nav-timetable");
    const navCommunity = document.getElementById("nav-community");
    const navAbout = document.getElementById("nav-about");

    function showTab(tab) {
      if (tab === "timetable") {
        timetableSection.style.display = "block";
        communitySection.style.display = "none";
        aboutSection.style.display = "none";

        navTimetable.classList.add("active");
        navCommunity.classList.remove("active");
        navAbout.classList.remove("active");

      } else if (tab === "community") {
        timetableSection.style.display = "none";
        communitySection.style.display = "block";
        aboutSection.style.display = "none";

        navTimetable.classList.remove("active");
        navCommunity.classList.add("active");
        navAbout.classList.remove("active");

        // Fade in community items
        const fadeItems = communitySection.querySelectorAll(".community-fade");
        fadeItems.forEach((item, idx) => {
          item.classList.remove("fade-in");
          item.style.opacity = 0;
          item.style.transform = "translateY(10px)";
          setTimeout(() => {
            item.classList.add("fade-in");
          }, idx * 100);
        });

      } else if (tab === "about") {
        timetableSection.style.display = "none";
        communitySection.style.display = "none";
        aboutSection.style.display = "block";

        navTimetable.classList.remove("active");
        navCommunity.classList.remove("active");
        navAbout.classList.add("active");

        // Fade in the about items
        const fadeItems = aboutSection.querySelectorAll(".community-fade");
        fadeItems.forEach((item, idx) => {
          item.classList.remove("fade-in");
          item.style.opacity = 0;
          item.style.transform = "translateY(10px)";
          setTimeout(() => {
            item.classList.add("fade-in");
          }, idx * 100);
        });
      }
    }

    // Default to Timetable tab
    showTab("timetable");

    // Nav button listeners
    navTimetable.addEventListener("click", () => showTab("timetable"));
    navCommunity.addEventListener("click", () => showTab("community"));
    navAbout.addEventListener("click", () => showTab("about"));
  </script>
</body>
</html>
